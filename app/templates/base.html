{% from 'macros.html' import index_link, option_link with context %}
<!DOCTYPE html>
<html>
<link rel="stylesheet" href="{{ url_for('static', filename='fontawesome-free-5.12.1-web/css/all.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='w3.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='application.css') }}">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ _('Technical and Computer Issues') }}</title>

<body class="w3-content">

    <div class="w3-bar w3-blue w3-xlarge">
        {% if current_user.is_authenticated %}
        <a class="w3-bar-item w3-hover-gray w3-button" href="javascript:open_sidebar()"><i class="fas fa-bars"></i></a>
        {% else %}
        <a class="w3-bar-item"><i class="fas fa-bars"></i></a>
        {% endif %}

        <a class="w3-bar-item w3-hover-gray w3-button w3-hide-small w3-hide-medium"
            href="{{ url_for('issue.index') }}">{{ _('Technical and Computer Issues') }}</a>
        <a class="w3-bar-item w3-hover-gray w3-button w3-button w3-hide-large"
            href="{{ url_for('issue.index') }}">{{ _('Issues') }}</a>

        <a class="w3-bar-item w3-right w3-hover-gray w3-button" href="{{ url_for('user.logout') }}"><i
                class="fas fa-sign-out-alt" aria-hidden="true"></i></a>

        <span class="w3-bar-item w3-right w3-hide-small">
            {% if session.get("username") %}
            {{ session.get("username") }}
            {% endif %}
        </span>
        <span class="w3-bar-item w3-right w3-hide-medium w3-hide-large">
            {% if session.get("username") %}
            {{ session.get("username").split(' ', 1)[0] }}
            {% endif %}
        </span>
    </div>

    <div class="w3-sidebar w3-bar-block" id="sidebar">
        {{ index_link('issue.index', _('View issues')) }}
        {% if current_user.role is defined and current_user.role.name == 'admin' %}
        {{ index_link('user.index', _('View users')) }}
        {% endif %}

        <div class="w3-dropdown-hover w3-hover-blue">
            <button class="w3-button">{{ _('Issue sorting') }}<i class="fas fa-caret-down"></i></button>
            <div class="w3-dropdown-content w3-bar-block">
                {{ option_link('issue.index', 'issue_sort', 'status', _('Sort by status (pending, processing, closed)')) }}
                {{ option_link('issue.index', 'issue_sort', 'date', _('Sort by update date')) }}
            </div>
        </div>

        <div class="w3-dropdown-hover w3-hover-blue">
            <button class="w3-button">{{ _('Issue filter') }}<i class="fas fa-caret-down"></i></button>
            <div class="w3-dropdown-content w3-bar-block">
                {{ option_link('issue.index', 'issue_type', 'all', _('All issues')) }}
                {{ option_link('issue.index', 'issue_type', 'computer', _('Computer issues')) }}
                {{ option_link('issue.index', 'issue_type', 'other', _('Technical issues')) }}
                </a>
            </div>
        </div>
    </div>

    <div class="w3-overlay w3-animate-opacity" onclick="close_sidebar()" style="cursor:pointer" id="overlay"></div>

    <div class="w3-panel">
        {% for category, message in get_flashed_messages(with_categories=true) %}
        {% if category == "error" %}
        <div class="w3-panel w3-pale-red">
            <p>{{ message }}</p>
        </div>
        {% else %}
        <div class="w3-panel w3-pale-green">
            <p>{{ message }}</p>
        </div>
        {% endif %}
        {% endfor %}

        {% block content %}{% endblock %}
    </div>

    <script type="text/javascript" src="{{ url_for('static', filename='application.js') }}"></script>
</body>

</html>
